# 🚀 版本发布指南

> 开发者发布新版本的完整流程

---

## 📋 发布前准备

### 1. 更新版本号

**修改文件**:
- [ ] `utils/updater.py` → `CURRENT_VERSION = "x.x.x"`
- [ ] `README.md` → 版本号更新
- [ ] `CHANGELOG.md` → 添加新版本记录

### 2. 测试验证

```powershell
# 运行所有测试
cd d:\JieDimension-Studio\JieDimension-Toolkit
python -m pytest tests/ -v

# 或运行特定测试
python tests/test_day24_gui.py
```

**目标**: 测试通过率 > 90%

### 3. 更新文档

- [ ] 更新 `CHANGELOG.md` 添加新版本条目
- [ ] 更新 `README.md` 功能说明（如有新功能）
- [ ] 检查所有文档链接有效性

---

## 📦 打包发布

### 步骤1: 重新打包

```powershell
cd d:\JieDimension-Studio\JieDimension-Toolkit

# 清理旧的构建
if (Test-Path build) { Remove-Item build -Recurse -Force }
if (Test-Path dist) { Remove-Item dist -Recurse -Force }

# 重新打包
pyinstaller JieDimension-Toolkit.spec --clean
```

### 步骤2: 压缩发布包

```powershell
cd dist
Compress-Archive -Path JieDimension-Toolkit -DestinationPath ..\release\JieDimension-Toolkit-v1.x.x-Windows.zip -Force
```

### 步骤3: 验证发布包

```powershell
# 测试运行
cd ..\release
Expand-Archive JieDimension-Toolkit-v1.x.x-Windows.zip -DestinationPath test_extract -Force
cd test_extract\JieDimension-Toolkit
.\JieDimension-Toolkit.exe

# 验证通过后删除测试目录
cd ..\..
Remove-Item test_extract -Recurse -Force
```

---

## 🌐 GitHub发布

### 步骤1: 提交代码

```powershell
cd d:\JieDimension-Studio\JieDimension-Toolkit

git add .
git commit -m "Release v1.x.x: [简短说明]"
git push origin main
```

### 步骤2: 创建Release

1. 访问 GitHub仓库页面
2. 点击 "Releases" → "Draft a new release"
3. 填写信息：
   - **Tag**: `v1.x.x`
   - **Title**: `JieDimension Toolkit v1.x.x - [标题]`
   - **Description**: 复制CHANGELOG对应部分

4. 上传文件：
   - `JieDimension-Toolkit-v1.x.x-Windows.zip`

5. 选择版本类型：
   - Beta版: 勾选 "This is a pre-release"
   - 正式版: 不勾选

6. 点击 "Publish release"

---

## 📝 Release说明模板

```markdown
# 🎉 JieDimension Toolkit v1.x.x

> [一句话版本亮点]

## ✨ 本版本亮点

### 🆕 新功能
- [功能1说明]
- [功能2说明]

### 🔧 改进
- [改进1说明]
- [改进2说明]

### 🐛 修复
- [修复1说明]
- [修复2说明]

## 🔄 热更新

**已安装v1.17.1或更高版本的用户**：
1. 打开应用 → ⚙️ 设置
2. 点击 🔄 版本更新 → ⚡ 一键更新
3. 自动下载安装，无需手动操作 ✨

**新用户**：
下载zip文件，解压后运行即可

## 📥 下载

- Windows 64位: `JieDimension-Toolkit-v1.x.x-Windows.zip` (XXX MB)

## 📚 文档

- [完整README](README.md)
- [快速开始](快速开始指南.md)
- [更新日志](CHANGELOG.md)

---

**发布日期**: 2025-xx-xx  
**测试通过率**: XX%  
**下载大小**: XXX MB
```

---

## ⚡ 热更新工作原理

### 用户侧（自动）

```
用户点击"一键更新"
  ↓
检查GitHub最新版本
  ↓
下载zip文件（显示进度）
  ↓
主程序退出
  ↓
批处理脚本启动
  ↓
备份旧版本到backup/
  ↓
解压新文件并替换
  ↓
重启应用
  ↓
✅ 更新完成！
```

### 开发者侧（简单）

```
开发新功能
  ↓
更新版本号
  ↓
打包（pyinstaller）
  ↓
压缩zip
  ↓
发布到GitHub Release
  ↓
✅ 完成！用户自动收到更新
```

---

## 🔍 版本号规范

### 格式: `Major.Minor.Patch`

- **Major** (主版本): 重大更新、架构变更
  - 例: 1.x.x → 2.0.0

- **Minor** (次版本): 新功能、新插件
  - 例: 1.17.x → 1.18.0

- **Patch** (补丁版本): Bug修复、小优化
  - 例: 1.17.1 → 1.17.2

### 示例

- `v1.17.1` → `v1.17.2`: Bug修复
- `v1.17.1` → `v1.18.0`: 添加抖音插件
- `v1.17.1` → `v2.0.0`: 架构重构

---

## 📊 发布检查清单

### 代码检查
- [ ] 所有功能正常工作
- [ ] 测试通过率 > 90%
- [ ] 无明显bug
- [ ] 版本号已更新

### 文档检查
- [ ] CHANGELOG已更新
- [ ] README功能说明准确
- [ ] 新功能有文档说明
- [ ] 所有链接有效

### 打包检查
- [ ] PyInstaller打包成功
- [ ] exe可以正常启动
- [ ] 所有依赖已包含
- [ ] 文件大小合理

### 发布检查
- [ ] zip文件创建成功
- [ ] GitHub Release创建
- [ ] 文件上传完成
- [ ] 发布说明完整

---

## 🎯 后续维护

### 用户反馈处理

1. **收集反馈**
   - GitHub Issues
   - 用户评论
   - 使用统计

2. **优先级排序**
   - 严重bug: 立即修复
   - 功能请求: 评估后实现
   - 优化建议: 计划迭代

3. **快速迭代**
   - 修复bug → 发布补丁版本
   - 用户一键更新获取修复

### 版本规划

**短期（1-2周）**:
- v1.17.x: Bug修复
- v1.18.0: 新功能（抖音等）

**中期（1-2月）**:
- v1.19.0: UI/UX优化
- v1.20.0: 真实发布完善

**长期（3-6月）**:
- v2.0.0: 架构优化
- SaaS化探索

---

## ✅ 总结

### 发布优势

有了热更新系统：
- ✅ 用户自动获取新版本
- ✅ 降低分发成本
- ✅ 提升更新率
- ✅ 快速修复bug

### 发布流程

```
开发 → 测试 → 打包 → GitHub → 用户自动更新
(你)   (你)   (你)   (你)     (自动完成)
```

**时间**: 每次发布仅需30分钟 ⚡

---

**创建时间**: 2025-10-09  
**适用版本**: v1.17.1+  
**状态**: ✅ 随时可用


